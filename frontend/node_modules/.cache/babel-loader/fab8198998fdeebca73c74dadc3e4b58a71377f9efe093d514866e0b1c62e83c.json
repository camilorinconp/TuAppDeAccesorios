{"ast":null,"code":"// ==================================================================\n// POINT OF SALE PAGE - ARQUITECTURA EMPRESARIAL\n// ==================================================================\nimport React,{useEffect}from'react';import{useAppDispatch,useAppSelector}from'../hooks/useAppDispatch';import{useDebounce}from'../hooks/useDebounce';import{SearchSection}from'../components/POS/SearchSection';import{CartSection}from'../components/POS/CartSection';import{SaleActions}from'../components/POS/SaleActions';import{StatusMessages}from'../components/POS/StatusMessages';import{searchProducts,setQuery,clearSearch}from'../store/slices/searchSlice';import{addToCart,removeFromCart,clearCart}from'../store/slices/cartSlice';import{processSale,clearSuccessMessage}from'../store/slices/saleSlice';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const POSPageEnterprise=()=>{const dispatch=useAppDispatch();// Selectores de estado\nconst{query,results,isLoading:searchLoading,error:searchError}=useAppSelector(state=>state.search);const{items:cartItems,totalAmount,totalItems}=useAppSelector(state=>state.cart);const{isProcessing,error:saleError,successMessage}=useAppSelector(state=>state.sale);// Debounce para optimizar búsquedas\nconst debouncedQuery=useDebounce(query,300);// Efecto para búsqueda automática\nuseEffect(()=>{if(debouncedQuery.trim()){dispatch(searchProducts(debouncedQuery));}else{dispatch(clearSearch());}},[debouncedQuery,dispatch]);// Limpiar mensaje de éxito después de 3 segundos\nuseEffect(()=>{if(successMessage){const timer=setTimeout(()=>{dispatch(clearSuccessMessage());},3000);return()=>clearTimeout(timer);}},[successMessage,dispatch]);// Handlers\nconst handleSearchChange=newQuery=>{dispatch(setQuery(newQuery));};const handleAddToCart=product=>{dispatch(addToCart(product));};const handleRemoveFromCart=productId=>{dispatch(removeFromCart(productId));};const handleFinalizeSale=async()=>{if(cartItems.length===0)return;const saleData={user_id:1,// TODO: Obtener del contexto de autenticación\nitems:cartItems.map(item=>({product_id:item.id,quantity_sold:item.quantity_in_cart,price_at_time_of_sale:item.selling_price})),total_amount:totalAmount};const result=await dispatch(processSale(saleData));// Si la venta fue exitosa, limpiar carrito y búsqueda\nif(processSale.fulfilled.match(result)){dispatch(clearCart());dispatch(setQuery(''));dispatch(clearSearch());}};return/*#__PURE__*/_jsxs(\"div\",{className:\"pos-page\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Punto de Venta\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"pos-layout\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"pos-left-panel\",children:/*#__PURE__*/_jsx(SearchSection,{query:query,results:results,isLoading:searchLoading,onQueryChange:handleSearchChange,onProductSelect:handleAddToCart})}),/*#__PURE__*/_jsxs(\"div\",{className:\"pos-right-panel\",children:[/*#__PURE__*/_jsx(CartSection,{items:cartItems,totalAmount:totalAmount,totalItems:totalItems,onRemoveItem:handleRemoveFromCart}),/*#__PURE__*/_jsx(SaleActions,{canFinalizeSale:cartItems.length>0&&!isProcessing,isProcessing:isProcessing,onFinalizeSale:handleFinalizeSale}),/*#__PURE__*/_jsx(StatusMessages,{searchError:searchError,saleError:saleError,successMessage:successMessage})]})]})]});};export default POSPageEnterprise;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}